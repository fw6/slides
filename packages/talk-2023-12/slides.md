---
theme: default
layout: center
highlighter: shiki
css: unocss
colorSchema: light
transition: fade-out
mdc: true
growX: 50
growY: 130
growSize: 1.5
favicon: /trip.ico
title: 'Gitæ·±å…¥æµ…å‡º'
titleTemplate: '%s - Slides'
---

<h1 flex="~ col">
<div text-2xl op80>Gitæ·±å…¥æµ…å‡º<devicon-git ml-1 /></div>
</h1>

<div uppercase text-sm tracking-widest op50>
UGCå‰ç«¯ç»„ å†¯ä¼Ÿ
</div>

<div abs-br mx-35 my-11 flex="~ col gap-4 items-end" text-left>
  <img src="/trip-group.png" h-7 alt="Trip.com Group">
  <div text-xs opacity-75 mt--4>2023/12/27</div>
</div>

<!--
ç»´åŸºç™¾ç§‘å°†Gitæè¿°ä¸ºä¸€ä¸ªåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶, æˆ‘ä»¬é¦–å…ˆæ¥äº†è§£ä¸‹ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
-->

---
layout: intro
---

## ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶(VCS)

<div mt-4 />

> ç‰ˆæœ¬æ§åˆ¶æ˜¯ä¸€ç§è®°å½•ä¸€ä¸ªæˆ–è‹¥å¹²æ–‡ä»¶å†…å®¹å˜åŒ–ï¼Œä»¥ä¾¿å°†æ¥æŸ¥é˜…ç‰¹å®šç‰ˆæœ¬ä¿®è®¢æƒ…å†µçš„ç³»ç»Ÿ


<div text-gray-500>
<v-clicks>

- æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ (å¦‚: [RCS](https://www.gnu.org/software/rcs/))
  - å¯ä»¥å¤åˆ¶æ•´ä¸ªé¡¹ç›®ç›®å½•æ¥ä¿å­˜ä¸åŒç‰ˆæœ¬, æ”¹å+å¤‡ä»½æ—¶é—´ä»¥ç¤ºåŒºåˆ«
  - RCSå·¥ä½œåŸç†æ˜¯åœ¨ç¡¬ç›˜ä¸Šä¿å­˜è¡¥ä¸é›†, åº”ç”¨æ‰€æœ‰çš„è¡¥ä¸, å¯ä»¥é‡æ–°è®¡ç®—å‡ºå„ä¸ªç‰ˆæœ¬çš„æ–‡ä»¶å†…å®¹

- é›†ä¸­åŒ–ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆCVCSï¼Œcentralized version control systemsï¼‰ (å¦‚: CVS, Subversion, Perforce)
  - å•ä¸€çš„é›†ä¸­ç®¡ç†çš„æœåŠ¡å™¨, ä¿å­˜æ‰€æœ‰æ–‡ä»¶çš„ä¿®è®¢ç‰ˆæœ¬
  - ååŒå·¥ä½œçš„äººä»¬éƒ½é€šè¿‡å®¢æˆ·ç«¯è¿åˆ°è¿™å°æœåŠ¡å™¨, å–å‡ºæœ€æ–°çš„æ–‡ä»¶æˆ–è€…æäº¤æ›´æ–°
  - æœ¬åœ°åªæœ‰å½“å‰ç‰ˆæœ¬ä»¥åŠéƒ¨åˆ†å†å²ä¿¡æ¯

- åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆDVCSï¼Œdistributed version control systemï¼‰ (å¦‚: Git, Mercurial, Bazaar, Darcs)
  - å®¢æˆ·ç«¯æŠŠä»£ç ä»“åº“å®Œæ•´åœ°é•œåƒä¸‹æ¥, åŒ…å«å®Œæ•´çš„å†å²è®°å½•
  - è¦å’Œå…¶ä»–äººåˆ†äº«å˜æ›´å†…å®¹æ—¶, æ‰éœ€è¦è¿æ¥ç½‘ç»œ

</v-clicks>
</div>


<!--
æœ‰äº†å®ƒï¼Œå°±èƒ½å°†ç‰¹å®šæ–‡ä»¶å›æº¯åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œç”šè‡³å°†æ•´ä¸ªé¡¹ç›®éƒ½å›é€€åˆ°è¿‡å»æŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€

å¯ä»¥æ¯”è¾ƒæ–‡ä»¶çš„å˜åŒ–ç»†èŠ‚ï¼ŒæŸ¥å‡ºæœ€åæ˜¯è°ä¿®æ”¹äº†å“ªä¸ªåœ°æ–¹ï¼Œä»è€Œæ‰¾å‡ºå¯¼è‡´æ€ªå¼‚é—®é¢˜å‡ºç°çš„åŸå› ï¼Œåˆæ˜¯è°åœ¨ä½•æ—¶æŠ¥å‘Šäº†æŸä¸ªåŠŸèƒ½ç¼ºé™·ç­‰ç­‰ã€‚

ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿé€šå¸¸è¿˜æ„å‘³ç€ï¼Œå°±ç®—ä½ ä¹±æ¥ä¸€æ°”æŠŠæ•´ä¸ªé¡¹ç›®ä¸­çš„æ–‡ä»¶æ”¹çš„æ”¹åˆ çš„åˆ ï¼Œä¹Ÿç…§æ ·å¯ä»¥è½»æ¾æ¢å¤åˆ°åŸå…ˆçš„æ ·å­ã€‚

ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿåˆ†ä¸º3ç§:
1. å¤åˆ¶æ•´ä¸ªé¡¹ç›®ç›®å½•æ¥ä¿å­˜ä¸åŒç‰ˆæœ¬ï¼Œæˆ–è®¸è¿˜ä¼šæ”¹å+å¤‡ä»½æ—¶é—´ä»¥ç¤ºåŒºåˆ«ã€‚å¥½å¤„æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯å®¹æ˜“çŠ¯é”™ã€‚æ¯”è¾ƒæµè¡Œçš„ä¸€ç§æ–¹å¼æ˜¯[RCS](https://www.gnu.org/software/rcs/)ï¼Œå·¥ä½œåŸç†æ˜¯åœ¨ç¡¬ç›˜ä¸Šä¿å­˜è¡¥ä¸é›†ï¼ˆè¡¥ä¸æ˜¯æŒ‡æ–‡ä»¶ä¿®è®¢å‰åçš„å˜åŒ–ï¼‰ï¼Œé€šè¿‡åº”ç”¨æ‰€æœ‰çš„è¡¥ä¸ï¼Œå¯ä»¥é‡æ–°è®¡ç®—å‡ºå„ä¸ªç‰ˆæœ¬çš„æ–‡ä»¶å†…å®¹ã€‚
2. è¿™ç±»ç³»ç»Ÿï¼Œè¯¸å¦‚CVSã€Subversionä»¥åŠPerforceç­‰ï¼Œéƒ½æœ‰ä¸€ä¸ªå•ä¸€çš„é›†ä¸­ç®¡ç†çš„æœåŠ¡å™¨ï¼Œä¿å­˜æ‰€æœ‰æ–‡ä»¶çš„ä¿®è®¢ç‰ˆæœ¬ï¼Œè€ŒååŒå·¥ä½œçš„äººä»¬éƒ½é€šè¿‡å®¢æˆ·ç«¯è¿åˆ°è¿™å°æœåŠ¡å™¨ï¼Œå–å‡ºæœ€æ–°çš„æ–‡ä»¶æˆ–è€…æäº¤æ›´æ–°ã€‚ç¼ºç‚¹æ˜¯ä¸­å¤®æœåŠ¡å™¨çš„å•ç‚¹æ•…éšœï¼Œå¦‚æœå®•æœºä¸€å°æ—¶ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸€å°æ—¶å†…ï¼Œè°éƒ½æ— æ³•æäº¤æ›´æ–°ï¼Œä¹Ÿå°±æ— æ³•ååŒå·¥ä½œã€‚å¦‚æœä¸­å¤®æ•°æ®åº“æ‰€åœ¨çš„ç£ç›˜å‘ç”ŸæŸåï¼Œæˆ–è€…æ•°æ®åº“å¤‡ä»½æ²¡åšå¥½ï¼Œå°±ä¼šå¯¼è‡´ä¸¢å¤±æ‰€æœ‰æ•°æ®ã€‚
3. è¿™ç±»ç³»ç»Ÿï¼Œè¯¸å¦‚Gitã€Mercurialã€Bazaarä»¥åŠDarcsç­‰ï¼Œå®¢æˆ·ç«¯ä¸åªæå–æœ€æ–°ç‰ˆæœ¬çš„æ–‡ä»¶å¿«ç…§ï¼Œè€Œæ˜¯æŠŠä»£ç ä»“åº“å®Œæ•´åœ°é•œåƒä¸‹æ¥ï¼ŒåŒ…æ‹¬å®Œæ•´çš„å†å²è®°å½•ã€‚

-->

---
layout: intro
growX: 80
growY: -10
---

## Gitä¸å…¶ä»–ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å·®åˆ«

æœ€ä¸»è¦å·®åˆ«åœ¨äºGitå¯¹å¾…æ•°æ®çš„æ–¹å¼

<v-clicks>

> å…¶ä»–å¤§éƒ¨åˆ†ç³»ç»Ÿä»¥æ–‡ä»¶å˜æ›´åˆ—è¡¨çš„æ–¹å¼å­˜å‚¨ä¿¡æ¯ï¼Œè¿™ç±»ç³»ç»Ÿ**å°†ä»–ä»¬å­˜å‚¨çš„ä¿¡æ¯çœ‹ä½œä¸€ç»„åŸºæœ¬æ–‡ä»¶å’Œæ¯ä¸ªæ–‡ä»¶éšæ—¶é—´é€æ­¥ç´¯ç§¯çš„å·®å¼‚**ã€‚ä»–ä»¬é€šå¸¸è¢«ç§°ä½œåŸºäºå·®å¼‚ï¼ˆdelta-basedï¼‰æˆ–å¢é‡ï¼ˆincrementalï¼‰çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚

<v-clicks relative>

<img of-hidden absolute :class="$clicks > 2 ? 'hidden' : ''" src="/delta_base.png" alt="CVCS é›†ä¸­åŒ–ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå›¾ç¤º" w-100 />

<div flex items-start gap-8>

<div>

**Gitæ›´åƒæ˜¯ä¸€ä¸ªå°å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæä¾›äº†è®¸å¤šä»¥æ­¤ä¸ºåŸºç¡€æ„å»ºçš„è¶…å¼ºå·¥å…·ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç®€å•çš„VCSã€‚**

1. å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ¬åœ°æ‰§è¡Œ
2. Gitåœ¨æ•°æ®å­˜å‚¨å‰è®¡ç®—æ ¡éªŒå’Œæ¥ä¿è¯å®Œæ•´æ€§
   > Gitç”¨äºè®¡ç®—æ ¡éªŒå’Œçš„æœºåˆ¶å«åšSHA-1æ•£åˆ—ï¼ˆhashï¼Œå“ˆå¸Œï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªç”±40ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼ˆ0-9å’Œa-fï¼‰ç»„æˆçš„å­—ç¬¦ä¸²ï¼ŒåŸºäºGitä¸­æ–‡ä»¶çš„å†…å®¹æˆ–ç›®å½•ç»“æ„è®¡ç®—å‡ºæ¥ã€‚å®é™…ä¸Šï¼ŒGitæ•°æ®åº“ä¸­ä¿å­˜çš„ä¿¡æ¯éƒ½æ˜¯ä»¥æ–‡ä»¶å†…å®¹çš„å“ˆå¸Œå€¼æ¥ç´¢å¼•ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åã€‚
3. Gitä¸€èˆ¬åªæ·»åŠ æ•°æ®

</div>

![Alt text](/snipshot_base.png){.w-240}

</div>


</v-clicks>
</v-clicks>

<!--

Gitä¸æŒ‰ç…§ä»¥ä¸Šæ–¹å¼å¯¹å¾…æˆ–ä¿å­˜æ•°æ®ã€‚åä¹‹ï¼ŒGitæ›´åƒæ˜¯æŠŠæ•°æ®çœ‹ä½œæ˜¯å¯¹å°å‹æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ç»„å¿«ç…§ã€‚

åœ¨Gitä¸­ï¼Œæ¯å½“ä½ æäº¤æ›´æ–°æˆ–ä¿å­˜é¡¹ç›®çŠ¶æ€æ—¶ï¼Œ**å®ƒåŸºæœ¬ä¸Šå°±ä¼šå¯¹å½“æ—¶çš„å…¨éƒ¨æ–‡ä»¶åˆ›å»ºä¸€ä¸ªå¿«ç…§å¹¶ä¿å­˜è¿™ä¸ªå¿«ç…§çš„ç´¢å¼•**ã€‚

ä¸ºäº†é«˜æ•ˆï¼Œå¦‚æœæ–‡ä»¶æ²¡æœ‰ä¿®æ”¹ï¼ŒGitä¸ä¼šå†æ¬¡ä¿å­˜è¯¥æ–‡ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªé“¾æ¥æŒ‡å‘ä¹‹å‰å­˜å‚¨çš„æ–‡ä»¶ã€‚Gitå¯¹å¾…æ•°æ®æ›´åƒæ˜¯ä¸€ä¸ª**å¿«ç…§æµ**(å†™å…¥æ—¶å¤åˆ¶æŠ€æœ¯å®ç°)ã€‚

1. å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ¬åœ°æ‰§è¡Œã€‚å¦‚ï¼šæµè§ˆé¡¹ç›®å†å²ã€æäº¤æ›´æ–°ã€æŸ¥çœ‹åˆ†æ”¯ç­‰ç­‰ã€‚æ„å‘³ç€ç¦»çº¿æƒ…å†µä¸‹å‡ ä¹å¯ä»¥è¿›è¡Œä»»ä½•æ“ä½œã€‚
2. Gitä¿è¯å®Œæ•´æ€§ã€‚Gitä¸­æ‰€æœ‰æ•°æ®åœ¨å­˜å‚¨å‰éƒ½è®¡ç®—æ ¡éªŒå’Œï¼Œç„¶åä»¥æ ¡éªŒå’Œæ¥å¼•ç”¨ã€‚è¿™æ„å‘³ç€ä¸å¯èƒ½åœ¨Gitä¸çŸ¥æƒ…æ—¶æ›´æ”¹ä»»ä½•æ–‡ä»¶å†…å®¹æˆ–ç›®å½•å†…å®¹ã€‚
   > Gitç”¨äºè®¡ç®—æ ¡éªŒå’Œçš„æœºåˆ¶å«åšSHA-1æ•£åˆ—ï¼ˆhashï¼Œå“ˆå¸Œï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªç”±40ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼ˆ0-9å’Œa-fï¼‰ç»„æˆçš„å­—ç¬¦ä¸²ï¼ŒåŸºäºGitä¸­æ–‡ä»¶çš„å†…å®¹æˆ–ç›®å½•ç»“æ„è®¡ç®—å‡ºæ¥ã€‚å®é™…ä¸Šï¼ŒGitæ•°æ®åº“ä¸­ä¿å­˜çš„ä¿¡æ¯éƒ½æ˜¯ä»¥æ–‡ä»¶å†…å®¹çš„å“ˆå¸Œå€¼æ¥ç´¢å¼•ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åã€‚
3. Gitä¸€èˆ¬åªæ·»åŠ æ•°æ®ã€‚å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½æ˜¯æ·»åŠ æ•°æ®ã€‚ä½ æ‰§è¡Œçš„å¤§éƒ¨åˆ†æ“ä½œï¼Œåªéœ€å‘æ•°æ®åº“ä¸­å¡«å…¥æ•°æ®ï¼Œè€Œå¾ˆå°‘ä¼šåšä»»ä½•ä¸å¯é€†çš„æ“ä½œï¼Œå¦‚åˆ é™¤æ•°æ®ã€‚

-->

---
layout: default
growX: 80
growY: 10
---

## ğŸ§ªå®éªŒ: åˆ›å»ºä¸€æ¡æäº¤

<div mt-8 />

<v-clicks>

```shell
$ git commit -a -m 'Initial commit'
```

<div mt-8 text-center text-4xl>ğŸ™…</div>

<div mt-8>

- åº•å±‚æŒ‡ä»¤: `git hash-object`ã€`git update-index`ã€`git write-tree`ã€`git commit-tree`
- ä¸Šå±‚æŒ‡ä»¤: `git commit`ã€`git add`ã€`git push`ã€`git pull`

</div>

</v-clicks>

<!--

æˆ‘ä»¬ä»¥åˆ›å»ºä¸€æ¬¡æäº¤å¼€å§‹,æ¥æ·±å…¥äº†è§£Gitçš„å·¥ä½œåŸç†
æ³¨æ„,ä¸ºäº†äº†è§£Gitçš„æœ¬è´¨, æ¥ä¸‹æ¥æˆ‘ä»¬ä¸ä¼šç›´æ¥ä½¿ç”¨`git commit`!

Gitæœ¬è´¨æ˜¯ä¸€ä¸ªå†…å®¹å¯»å€æ–‡ä»¶ç³»ç»Ÿ,å¹¶åœ¨æ­¤åŸºç¡€ä¸Šæä¾›äº†ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ç”¨æˆ·ç•Œé¢

Gitæœ€åˆæ˜¯ä¸€å¥—é¢å‘ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å·¥å…·é›†,è€Œä¸æ˜¯å®Œæ•´çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ,æ‰€ä»¥å®ƒè¿˜åŒ…å«äº†ä¸€éƒ¨åˆ†ç”¨äºå®Œæˆåº•å±‚å·¥ä½œçš„å­å‘½ä»¤, ä¸€èˆ¬ç§°è¿™éƒ¨åˆ†å‘½ä»¤ä¸ºåº•å±‚å‘½ä»¤,è€Œé‚£äº›æ›´å‹å¥½çš„å‘½ä»¤è¢«ç§°ä¸ºä¸Šå±‚å‘½ä»¤.

åº•å±‚å‘½ä»¤å¾—ä»¥è®©ä½ çª¥æ¢Gitå†…éƒ¨çš„å·¥ä½œæœºåˆ¶,ä¹Ÿæœ‰åŠ©äºè¯´æ˜Gitæ˜¯å¦‚ä½•è¿ä½œçš„

æ¼”ç¤º: åˆ›å»ºç©ºé¡¹ç›®, è®²è§£.gitç›®å½•ç»“æ„

.gitç›®å½•åŒ…å«äº†å‡ ä¹æ‰€æœ‰Gitå­˜å‚¨å’Œæ“ä½œçš„ä¸œè¥¿.å¦‚éœ€å¤‡ä»½æˆ–å¤åˆ¶ä¸€ä¸ªç‰ˆæœ¬åº“,åªéœ€è¦å¤åˆ¶è¿™ä¸ªç›®å½•å³å¯

- config: é¡¹ç›®ç‰¹æœ‰çš„é…ç½®é€‰é¡¹
- info: åŒ…å«ä¸€ä¸ªå…¨å±€æ€§æ’é™¤æ–‡ä»¶,ç”¨ä»¥æ”¾ç½®é‚£äº›ä¸å¸Œæœ›è¢«è®°å½•åœ¨.gitignoreæ–‡ä»¶ä¸­çš„å¿½ç•¥æ¨¡å¼
- hooks: åŒ…å«å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯çš„é’©å­è„šæœ¬
- objects: å­˜å‚¨æ‰€æœ‰æ•°æ®å†…å®¹
- refs: å­˜å‚¨æŒ‡å‘æ•°æ®(åˆ†æ”¯ã€è¿œç¨‹ä»“åº“ã€æ ‡ç­¾ç­‰)çš„æäº¤å¯¹è±¡çš„æŒ‡é’ˆ
- HEAD: æŒ‡å‘å½“å‰æ‰€åœ¨åˆ†æ”¯çš„æŒ‡é’ˆ
- index: æš‚å­˜åŒºä¿¡æ¯

Gitçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç®€å•çš„é”®å€¼å¯¹æ•°æ®åº“,å¯ä»¥é€šè¿‡é”®(å†…å®¹çš„å“ˆå¸Œå€¼)æ¥è®¿é—®å€¼(æ–‡ä»¶å†…å®¹),è¿™ä¸ªæ•°æ®åº“è¢«ç§°ä¸ºå¯¹è±¡æ•°æ®åº“

-->

---
layout: center
growX: 0
growY: 70
---

### åˆ›å»ºæ•°æ®å¯¹è±¡

<div mt-4 />

1. `echo "some text" | git hash-object -w --stdin` å†™å…¥æ–‡ä»¶å†…å®¹åˆ°Gitæ•°æ®åº“
2. `git cat-file -p <hash>` æŸ¥çœ‹å¯¹è±¡å†…å®¹(`-p` é€‰é¡¹æŒ‡ç¤ºè‡ªåŠ¨åˆ¤æ–­æ–‡ä»¶ç±»å‹)
3. `git hash-object -w <file>` å°†æ–‡ä»¶å†…å®¹å†™å…¥å¯¹è±¡æ•°æ®åº“, å¹¶è¿”å›è¯¥å¯¹è±¡çš„å“ˆå¸Œå€¼
4. `git cat-file -t <hash>` æŸ¥çœ‹å¯¹è±¡ç±»å‹ (`blob`)
5. `tree .git/objects` æŸ¥çœ‹å­˜å…¥çš„æ•°æ®

<!--

1. åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®,å¹¶æ‰§è¡Œ`git init`åˆå§‹åŒ–
2. æ¼”ç¤ºç©ºçš„`objects`ç›®å½•
3. é€šè¿‡`git hash-object`å‘½ä»¤,å°†ä¸€ä¸ªæ–‡ä»¶å†…å®¹å†™å…¥å¯¹è±¡æ•°æ®åº“,å¹¶è¿”å›è¯¥å¯¹è±¡çš„å“ˆå¸Œå€¼`echo "some text" | git hash-object -w --stdin`
4. ä¸Šè¿°å‘½åè¾“å‡º40ä¸ªå­—ç¬¦çš„æ ¡éªŒå’Œ,è¿™ä¸ªæ ¡éªŒå’Œæ˜¯å¯¹è±¡çš„åå­—
5. æ­¤æ—¶æŸ¥çœ‹objectsç›®å½•,å¯ä»¥æ‰¾åˆ°ä¸æ–°å†…å®¹å¯¹åº”çš„æ–‡ä»¶,æ ¡éªŒå’Œå‰2ä¸ªå­—ç¬¦ä½œä¸ºç›®å½•å,å38ä¸ªå­—ç¬¦ä½œä¸ºæ–‡ä»¶å
6. ä¸€æ—¦å°†å†…å®¹å­˜å‚¨åœ¨å¯¹è±¡æ•°æ®åº“ä¸­, å¯é€šè¿‡`git cat-file -p <hash>`æŸ¥çœ‹å¯¹è±¡å†…å®¹(-pé€‰é¡¹æŒ‡ç¤ºè‡ªåŠ¨åˆ¤æ–­æ–‡ä»¶ç±»å‹)
7. æ¥ä¸‹æ¥åˆ›å»ºä¸ªæ–°æ–‡ä»¶,å¹¶é€šè¿‡hash-objectå­˜å…¥æ•°æ®åº“ä¸­, ä¿®æ”¹ä¸‹å†…å®¹,å†æ¬¡å­˜å…¥
8. æ­¤æ—¶å¯¹è±¡æ•°æ®åº“è®°å½•äº†è¯¥æ–‡ä»¶çš„ä¸¤ä¸ªç‰ˆæœ¬(å­˜å…¥çš„ç¬¬ä¸€æ¡æ•°æ®è¿˜åœ¨, tree .git æŸ¥çœ‹)
9. ä¸Šè¿°è®°å½•çš„ä¸ºæ•°æ®å¯¹è±¡ (è¿è¡Œ`git cat-file -t <hash>`æŸ¥çœ‹), è®°å½•æ–‡ä»¶çš„æ¯ä¸€ä¸ªç‰ˆæœ¬å¹¶ä¸ç°å®,æ­¤å¤–æ–‡ä»¶åä¹Ÿæ— æ³•è®°å½•


-->

---
layout: center
growX: 10
growY: 80
---

### åˆ›å»ºæ ‘å¯¹è±¡

<div mt-4 />

1. `git update-index --add --cacheinfo 100644 <hash> <file>` å°†æ•°æ®å¯¹è±¡æ·»åŠ åˆ°æš‚å­˜åŒº
2. `git ls-files --stage` æŸ¥çœ‹æš‚å­˜åŒºå†…å®¹
3. `git write-tree` å°†æš‚å­˜åŒºå†…å®¹å†™å…¥å¯¹è±¡æ•°æ®åº“,å¹¶è¿”å›æ ‘å¯¹è±¡çš„å“ˆå¸Œå€¼
4. `git cat-file -t <hash>` æŸ¥çœ‹å¯¹è±¡ç±»å‹ (`tree`)

![Alt text](/tree_object.png){.w-120}

<!--

æ¥ä¸‹æ¥æ¢è®¨æ ‘å¯¹è±¡,å®ƒèƒ½è§£å†³ æ–‡ä»¶åä¿å­˜é—®é¢˜,ä¹Ÿèƒ½å°†å¤šä¸ªæ–‡ä»¶ç»„ç»‡åˆ°ä¸€èµ·

Gitä½¿ç”¨ç±»ä¼¼unixæ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼æ¥å­˜å‚¨æ ‘å¯¹è±¡. ä¸€ä¸ªæ ‘å¯¹è±¡åŒ…å«1æˆ–å¤šæ¡æ•°å¯¹è±¡è®°å½•,æ¯æ¡è®°å½•å«æœ‰ä¸€ä¸ªæŒ‡å‘æ•°æ®å¯¹è±¡æˆ–å­æ ‘å¯¹è±¡çš„æŒ‡é’ˆ,ä»¥åŠç›¸åº”çš„æ¨¡å¼ã€ç±»å‹ã€æ–‡ä»¶åä¿¡æ¯(éšä¾¿æ‰¾ä¸ªé¡¹ç›®, é€šè¿‡`git cat-file -p main^{tree}`æŸ¥çœ‹)

å¦‚ä¸Šå›¾,å±•ç¤ºäº†ç®€åŒ–ç‰ˆçš„æ ‘å¯¹è±¡æ¨¡å‹

é€šå¸¸, Gitæ ¹æ®æŸä¸€æ—¶åˆ»æš‚å­˜åŒº(å³IndexåŒºåŸŸ)æ‰€è¡¨ç¤ºçš„çŠ¶æ€åˆ›å»ºå¹¶è®°å½•ä¸€ä¸ªå¯¹åº”çš„æ ‘å¯¹è±¡,å¦‚æ­¤é‡å¤ä¾¿å¯ä¾æ¬¡è®°å½•(æŸä¸ªæ—¶é—´æ®µå†…)ä¸€ç³»åˆ—æ ‘å¯¹è±¡

ä¸ºåˆ›å»ºä¸€ä¸ªæ ‘å¯¹è±¡,æˆ‘ä»¬éœ€è¦æš‚å­˜ä¸€äº›æ–‡ä»¶åˆ°æš‚å­˜åŒº

æ¼”ç¤º:
1. æ‰§è¡Œ`git update-index --add --cacheinfo 100644 <hash> <file>`å°†æ•°æ®å¯¹è±¡æ·»åŠ åˆ°æš‚å­˜åŒº(100644è¡¨æ˜æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶, å‚è€ƒUNIXå¸¸è§çš„æ–‡ä»¶æ¨¡å¼)
2. ä¸Šè¿°å‘½ä»¤å°†æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¿å­˜åˆ°äº†æš‚å­˜åŒº, é€šè¿‡`git ls-files --stage`æŸ¥çœ‹æš‚å­˜åŒºå†…å®¹
3. æ¥ä¸‹æ¥,é€šè¿‡`git write-tree`å‘½ä»¤å°†æš‚å­˜åŒºå†…å®¹å†™å…¥å¯¹è±¡æ•°æ®åº“,å¹¶è¿”å›æ ‘å¯¹è±¡çš„å“ˆå¸Œå€¼
4. æ­¤æ—¶æ‰§è¡Œ`git cat-file -t <hash>`æŸ¥çœ‹å¯¹è±¡ç±»å‹,å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªæ ‘å¯¹è±¡
5. æ¥ä¸‹æ¥æˆ‘ä»¬å†å°†æ–‡ä»¶çš„ç¬¬äºŒä¸ªç‰ˆæœ¬æ·»åŠ åˆ°æš‚å­˜åŒº,å¹¶æ–°å¢ä¸€ä¸ªæ–‡ä»¶,å¹¶é€šè¿‡`git write-tree`å‘½ä»¤å°†æš‚å­˜åŒºå†…å®¹å†™å…¥å¯¹è±¡æ•°æ®åº“,å¹¶è¿”å›æ ‘å¯¹è±¡çš„å“ˆå¸Œå€¼
6. æ‰§è¡Œ`git cat-file -p <hash>`æŸ¥çœ‹æ ‘å¯¹è±¡å†…å®¹,å¯ä»¥çœ‹åˆ°æ ‘å¯¹è±¡è®°å½•äº†æ–‡ä»¶çš„æœ€æ–°ç‰ˆæœ¬,ä»¥åŠæ–°å¢çš„æ–‡ä»¶

-->

---
layout: center
growX: 10
growY: 120
---

### åˆ›å»ºæäº¤å¯¹è±¡

<div mt-4 />

1. `git commit-tree <hash> -m 'Initial commit'` åˆ›å»ºæäº¤å¯¹è±¡,å¹¶è¿”å›æäº¤å¯¹è±¡çš„å“ˆå¸Œå€¼
2. `git log --stat <hash>` æŸ¥çœ‹æäº¤å¯¹è±¡å†…å®¹

![Alt text](/commit_test_graph.png){.mt-8.w-160}

<!--

ä¸Šä¸€æ­¥,æˆ‘ä»¬å¾—åˆ°äº†2ä¸ªæ ‘å¯¹è±¡, åˆ†åˆ«ä»£è¡¨æˆ‘ä»¬æƒ³è¦è·Ÿè¸ªçš„ä¸åŒé¡¹ç›®çš„å¿«ç…§

ç„¶è€Œè¦é‡ç”¨è¿™äº›å¿«ç…§,æˆ‘ä»¬å¿…é¡»è®°ä½ä¸Šè¿°ä¸¤ä¸ªæ ‘å¯¹è±¡çš„å“ˆå¸Œå€¼, å¹¶ä¸”å®Œå…¨ä¸çŸ¥é“è°ä¿å­˜äº†å¿«ç…§,åœ¨ä»€ä¹ˆæ—¶åˆ»ä¿å­˜äº†è¿™äº›å¿«ç…§,ä»¥åŠä¸ºä»€ä¹ˆä¿å­˜å¿«ç…§

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, Gitå¼•å…¥äº†æäº¤å¯¹è±¡

æ¼”ç¤º:
1. æ‰§è¡Œ`git commit-tree <hash> -m 'Initial commit'`å‘½ä»¤,åˆ›å»ºä¸€ä¸ªæäº¤å¯¹è±¡,å¹¶è¿”å›æäº¤å¯¹è±¡çš„å“ˆå¸Œå€¼
2. æ­¤æ—¶æ‰§è¡Œ`git cat-file -p <hash>`æŸ¥çœ‹æäº¤å¯¹è±¡å†…å®¹,å¯ä»¥çœ‹åˆ°æäº¤å¯¹è±¡è®°å½•äº†æ ‘å¯¹è±¡çš„å“ˆå¸Œå€¼,ä»¥åŠæäº¤ä¿¡æ¯
3. æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºç¬¬äºŒä¸ªæäº¤å¯¹è±¡`git commit-tree <hash> -p <prev hash> -m 'Second commit'`
4. æ­¤æ—¶æ‰§è¡Œ`git log --stat <hash>`, å¯æŸ¥çœ‹åˆ°æˆ‘ä»¬å…ˆå‰çš„ä¸¤æ¬¡æäº¤

ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬è¿è¡Œ`git add`+`git commit`å‘½ä»¤æ—¶,Gitæ‰€åšçš„å·¥ä½œ:
> å°†è¢«æ”¹å†™çš„æ•°æ®ä¿å­˜ä¸ºæ•°æ®å¯¹è±¡ã€æ›´æ–°æš‚å­˜åŒºã€è®°å½•æ ‘å¯¹è±¡,æœ€ååˆ›å»ºä¸€ä¸ªæŒ‡æ˜é¡¶å±‚æ ‘å¯¹è±¡å’Œçˆ¶æäº¤çš„æäº¤å¯¹è±¡

è¿™ä¸‰ç§ä¸»è¦çš„Gitå¯¹è±¡â€”â€”æ•°æ®å¯¹è±¡ã€æ ‘å¯¹è±¡å’Œæäº¤å¯¹è±¡, æœ€åˆéƒ½ä»¥å•ç‹¬æ–‡ä»¶çš„æ ¼å¼ä¿å­˜åœ¨`.git/objects`ç›®å½•ä¸‹(æ‰§è¡Œ`tree .git/objects`æŸ¥çœ‹)

æœ€ç»ˆè¿™ä¸¤æ¬¡æäº¤çš„å…³ç³»å¦‚å›¾æ‰€ç¤º

-->

---
layout: intro
growX: 120
growY: 20
---

### `references`å¼•ç”¨

<div mt-5 />

<v-click>

```shell
$ echo ffda080b84b4a640d811a9d653151675dc76ea33 > .git/refs/heads/master
```

> âš ï¸ â€¼ï¸: éœ€è¦å®Œæ•´çš„SHA-1å€¼

<div pt-4 />

```shell
$ git update-ref refs/heads/master 4e5825
```

</v-click>

<v-click>

![Alt text](/commit_test_refs_branch.png){.mt-8.h-60}

</v-click>

<!--

æˆ‘ä»¬å‰é¢åˆ›å»ºäº†2æ¬¡æäº¤,ä½†æ˜¯æ¯æ¬¡æŸ¥çœ‹éƒ½éœ€è¦è¾“å…¥æäº¤å¯¹è±¡çš„å“ˆå¸Œå€¼,è¿™æ ·å¾ˆä¸æ–¹ä¾¿

å¦‚æœæœ‰ä¸ªæ–‡ä»¶èƒ½ä¿å­˜SHA-1å€¼,è€Œè¯¥æ–‡ä»¶æœ‰ä¸ªç®€å•çš„åå­—,ç„¶åç”¨è¿™ä¸ªåå­—æ›¿ä»£åŸå§‹çš„SHA-1å€¼,é‚£å°±å¤ªæ–¹ä¾¿äº†.

åœ¨Gitä¸­,è¿™ç§ç®€å•çš„åå­—è¢«ç§°ä¸ºå¼•ç”¨(Reference),å®ƒä»¬å­˜å‚¨åœ¨`.git/refs`ç›®å½•ä¸‹

åˆ›å»ºä¸€ä¸ªå¼•ç”¨,ä½¿ç”¨è¿™ä¸¤ä¸ªå‘½ä»¤éƒ½å¯ä»¥,ä½†ä¸æå€¡ç¬¬ä¸€ç§é‚£æ ·ç›´æ¥ç¼–è¾‘å¼•ç”¨æ–‡ä»¶
æ­¤æ—¶æ‰§è¡Œ`git log <branch>`ä¸æ‰§è¡Œ`git log <hash>`æ•ˆæœæ˜¯ä¸€è‡´çš„.

è€Œè¿™å°±æ˜¯Gitåˆ†æ”¯çš„æœ¬è´¨äº†, ä¸€ä¸ªæŒ‡å‘æŸä¸€ç³»åˆ—æäº¤ä¹‹é¦–çš„æŒ‡é’ˆæˆ–å¼•ç”¨.
å½“è¿è¡Œ`git branch <branch>`æ—¶, Gitå®é™…ä¸Šä¼šæ‰§è¡Œ`git update-ref`å‘½ä»¤, å–å¾—å½“å‰æ‰€åœ¨åˆ†æ”¯çš„æœ€æ–°æäº¤å¯¹åº”çš„SHA-1å€¼å¹¶å°†å…¶åŠ å…¥åˆ°ä½ è¦åˆ›å»ºçš„ä»»ä½•å¼•ç”¨ä¸­
è¿™é‡Œå…¶å®è¿˜æœ‰ä¸ªå‘, ,å½“æ‰§è¡Œ`git branch <branch>`æ—¶Gitå¦‚ä½•çŸ¥é“æœ€æ–°æäº¤çš„SHA-1å€¼å‘¢? è¿™é‡Œå°±è¦æåˆ°HEADæŒ‡é’ˆäº†, æˆ‘ä»¬å…ˆæš‚æ—¶ä¸è®²,åé¢ä¼šè¯¦ç»†ä»‹ç»

æ¥ä¸‹æ¥,æˆ‘ä»¬ç»§ç»­æ¢ç©¶Gitåˆ†æ”¯åŸç†

-->

---
layout: default
growX: 100
growY: 10
---

## Gitåˆ†æ”¯åŸç†

> Gitä¿å­˜çš„ä¸æ˜¯æ–‡ä»¶çš„å·®å¼‚æˆ–å˜åŒ–,è€Œæ˜¯ä¸€ç³»åˆ—ä¸åŒæ—¶åˆ»çš„**å¿«ç…§**

<div flex items-center mt-8>
<v-clicks>

![Alt text](/branch_deepin.png){.h-50}

<div pl-4 self-stretch>

![Alt text](/commit_object.png){.w-120}

</div>

</v-clicks>

</div>
<v-click>

**Gitçš„åˆ†æ”¯,æœ¬è´¨ä¸Šä»…ä»…æ˜¯æŒ‡å‘æäº¤å¯¹è±¡çš„å¯å˜æŒ‡é’ˆ**

</v-click>

<!--

Gitçš„åˆ†æ”¯æ¨¡å‹è¢«ç§°ä¸ºå®ƒçš„å¿…æ€æŠ€ç‰¹æ€§. å…¶å¤„ç†åˆ†æ”¯çš„æ–¹å¼å¯è°“æ˜¯éš¾ä»¥ç½®ä¿¡çš„è½»é‡,åˆ›å»ºæ–°åˆ†æ”¯å‡ ä¹åœ¨ç¬é—´å®Œæˆ, å¹¶ä¸”è¿›è¡Œåˆ†æ”¯åˆ‡æ¢ä¹Ÿæ˜¯ä¸€æ ·ä¾¿æ·.

å›å¿†ä¸‹å‰é¢æ¼”ç¤ºçš„, Gitæ˜¯ä»–å¦‚ä½•ä¿å­˜æ•°æ®çš„
å½“ä½¿ç”¨`git commit`æ—¶,Gitä¼šå…ˆè®¡ç®—æ¯ä¸€ä¸ªå­ç›®å½•çš„æ ¡éªŒå’Œ,ç„¶ååœ¨Gitä»“åº“ä¸­å°†è¿™äº›æ ¡éªŒå’Œä¿å­˜ä¸ºæ ‘å¯¹è±¡,Gitä¼šåˆ›å»ºä¸€ä¸ªæäº¤å¯¹è±¡,åŒ…å«æŒ‡å‘æ ‘å¯¹è±¡çš„æŒ‡é’ˆ.

Gitä»“åº“ä¸­æœ‰è¿™å‡ ä¸ªå¯¹è±¡: Blobå¯¹è±¡(ä¿å­˜æ–‡ä»¶å¿«ç…§)ã€ä¸€ä¸ªæ ‘å¯¹è±¡(è®°å½•ç›®å½•ç»“æ„å’Œblobå¯¹è±¡ç´¢å¼•)ä»¥åŠä¸€ä¸ªæäº¤å¯¹è±¡(åŒ…å«æŒ‡å‘å‰è¿°æ ‘å¯¹è±¡çš„æŒ‡é’ˆå’Œæ‰€æœ‰æäº¤ä¿¡æ¯)

è€ŒGitçš„åˆ†æ”¯, æœ¬è´¨ä¸Šä»…ä»…æ˜¯æŒ‡å‘æäº¤å¯¹è±¡çš„å¯å˜æŒ‡é’ˆ.

ä¹Ÿå°±æ˜¯åœ¨`.git/refs/heads`ç›®å½•ä¸‹çš„æ–‡ä»¶, éƒ½æ˜¯è¯¥ä»“åº“çš„æœ¬åœ°åˆ†æ”¯
æ—¢ç„¶æœ‰æœ¬åœ°åˆ†æ”¯, é‚£ä¹ˆè‚¯å®šè¿˜æœ‰è¿œç¨‹åˆ†æ”¯, è¿œç¨‹åˆ†æ”¯ä¿å­˜åœ¨`.git/refs/remotes`ç›®å½•ä¸‹

-->

---
layout: two-cols-header
growX: 80
growY: 10
---

## è¿œç¨‹åˆ†æ”¯

::left::

![Alt text](/remote_branch.png){.w-100}

::right::

![Alt text](/forked_remote_branch.png){.w-100}

<!--

Gitä¸­çš„è¿œç¨‹è·Ÿè¸ªåˆ†æ”¯æ˜¯è¿œç¨‹åˆ†æ”¯çŠ¶æ€çš„å¼•ç”¨, å®ƒä»¬æ˜¯ä½ æ— æ³•ç§»åŠ¨çš„æœ¬åœ°å¼•ç”¨. ä¸€æ—¦è¿›è¡Œç½‘ç»œé€šä¿¡,Gitä¼šè‡ªåŠ¨åœ°æ›´æ–°è¿œç¨‹è·Ÿè¸ªåˆ†æ”¯çš„ä½ç½®.

å¯ä»¥æŠŠä»–ä»¬ç±»æ¯”ä¹¦ç­¾ğŸ”–, å¯ä»¥æé†’ä½ è¯¥åˆ†æ”¯åœ¨è¿œç¨‹ä»“åº“ä¸­çš„ä½ç½®å°±æ˜¯ä½ æœ€åä¸€æ¬¡è¿æ¥åˆ°ä»–ä»¬çš„ä½ç½®

> ä½¿ç”¨`git branch -a`åˆ—å‡ºæ‰€æœ‰çš„è¿œç¨‹åˆ†æ”¯ä¸æœ¬åœ°åˆ†æ”¯

è¿œç¨‹åˆ†æ”¯ä»¥`<remote>/<branch>`

è¦ä¸ç»™å®šçš„è¿œç¨‹ä»“åº“åŒæ­¥æ•°æ®,è¿è¡Œ`git fetch <remote>`å‘½ä»¤,è¿™ä¸ªå‘½ä»¤æŸ¥æ‰¾`origin`æ˜¯å“ªä¸ªæœåŠ¡å™¨å¹¶ä»ä¸­æŠ“å–æœ¬åœ°æ²¡æœ‰çš„æ•°æ®,æ›´æ–°æœ¬åœ°æ•°æ®åº“,ç§»åŠ¨`origin/<branch name>`æŒ‡é’ˆåˆ°æ›´æ–°ä¹‹åçš„ä½ç½®

æ¯æ¬¡ä»è¿œç¨‹ä»“åº“æŠ“å–,æœ¬åœ°ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä»½å¯ç¼–è¾‘å‰¯æœ¬,åªæœ‰ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„`origin/server_issue233`æŒ‡é’ˆ
-->

---
layout: intro
growX: 80
growY: 50
---

## è·Ÿè¸ªåˆ†æ”¯

è·Ÿè¸ªåˆ†æ”¯æ˜¯ä¸è¿œç¨‹åˆ†æ”¯æœ‰ç›´æ¥å…³ç³»çš„æœ¬åœ°åˆ†æ”¯

<v-clicks>

```shell
$ git checkout -b issue233 origin/issue233
$ git checkout --track origin/issue233
```

```shell
$ git branch -u origin/server_issue233
```

```shell
$ git merge @{u}
$ git rebase @{u}
```

```shell
$ git branch -vv
* develop 0997a9f [origin/develop: behind 147] fix: ç¡®è®¤è·³è½¬å‘å¸ƒé¡µå‚æ•°
  release 65304cb [origin/release] Merge branch 'feat233' into 'release'
```

</v-clicks>

<!--


ä»ä¸€ä¸ªè¿œç¨‹è·Ÿè¸ªåˆ†æ”¯æ£€å‡ºä¸€ä¸ªæœ¬åœ°åˆ†æ”¯ä¼šè‡ªåŠ¨åˆ›å»ºæ‰€è°“çš„â€œè·Ÿè¸ªåˆ†æ”¯â€(å®ƒè·Ÿè¸ªçš„åˆ†æ”¯è¢«ç§°ä¸ºä¸Šæ¸¸åˆ†æ”¯).

ä½ å¯ä»¥åœ¨ä»»æ„æ—¶é—´ä¿®æ”¹è·Ÿè¸ªçš„ä¸Šæ¸¸åˆ†æ”¯

è®¾ç½®å¥½ä¸Šæ¸¸åˆ†æ”¯å,å¯ä»¥é€šè¿‡ç®€å†™`@{upstream}`æˆ–`@{u}`æ¥å¼•ç”¨ä¸Šæ¸¸åˆ†æ”¯.

è¦æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„è·Ÿè¸ªåˆ†æ”¯,å¯ä»¥è¿è¡Œ`git branch -vv`


å¯ä»¥çœ‹åˆ°æ­£åœ¨è·Ÿè¸ªçš„è¿œç¨‹åˆ†æ”¯æ˜¯å¦é¢†å…ˆ/è½å

> è¿™äº›æ•°å­—çš„å€¼å¹¶éå‡†ç¡®,å–å†³äºä½ ä¸Šæ¬¡æŠ“å–çš„æ•°æ®`git fetch`.
> è¿™ä¸ªå‘½ä»¤å¹¶æ²¡æœ‰è”ç½‘,åªæ˜¯å‘Šè¯‰ä½ å…³äºæœ¬åœ°ç¼“å­˜çš„æœåŠ¡å™¨æ•°æ®

-->

---
layout: intro
clicks: 1
growX: 20
growY: 10
---

## æ‹‰å–

<div>

<code>git pull</code><span :class="[$clicks > 0 ? '' : 'hidden']"> = <code>git fetch</code> + <code>git merge</code></span>

</div>

```
	  A---B---C master on origin
	 /
D---E---F---G master
	^
	ä½ ä»“åº“ä¸­çš„ origin/master
```

<div mt-4 />

```
	  A---B---C origin/master
	 /         \
D---E---F---G---H master
```

<!--

ä½¿ç”¨`git fetch`ä»æœåŠ¡å™¨æŠ“å–æœ¬åœ°æ²¡æœ‰çš„å†…å®¹æ—¶,å®ƒå¹¶ä¸ä¼šä¿®æ”¹å·¥ä½œç›®å½•ä¸­çš„å†…å®¹
å®ƒåªä¼šè·å–æ•°æ®å‘Šè¯‰ä½ æœ¬åœ°åˆ†æ”¯è½åè¿œç¨‹åˆ†æ”¯å¤šå°‘æäº¤

å¦‚æœä½ æƒ³è¦è‡ªåŠ¨åˆå¹¶è¿œç¨‹åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯,å¯ä»¥ä½¿ç”¨`git pull`å‘½ä»¤
ä½¿ç”¨`git pull`è¿›è¡Œæ‹‰å–æ“ä½œ,å¯ä»¥ç†è§£ä¸º`git fetch`+`git merge`

å¦‚æœå½“å‰æ˜¯ä¸€ä¸ªè·Ÿè¸ªåˆ†æ”¯,`git pull`ä¼šæŸ¥æ‰¾å½“å‰åˆ†æ”¯è·Ÿè¸ªçš„æœåŠ¡å™¨ä¸åˆ†æ”¯,ä»æœåŠ¡å™¨æŠ“å–æ•°æ®ç„¶åå°è¯•å¿«é€Ÿåˆå¹¶å…¥è¿œç¨‹åˆ†æ”¯.
å¦‚æœæœ‰å†²çª,å¯ä»¥æŒ‡å®š`--rebase`é€‰é¡¹,è¿™æ ·Gitä¼šç”¨ä½ çš„æäº¤è¦†ç›–è¿œç¨‹åˆ†æ”¯,è€Œä¸æ˜¯ç”¨è¿œç¨‹åˆ†æ”¯çš„æäº¤è¦†ç›–ä½ çš„æäº¤

å‡è®¾å½“å‰åˆ†æ”¯åœ¨master, æ‰§è¡Œ`git pull`è·å–è¿œç¨‹åˆ†æ”¯å¹¶é‡æ”¾ä¸æœ¬åœ°åˆ†æ”¯æœ‰åˆ†æ­§(E)ä»¥æ¥çš„å˜åŒ–,æœ€åå°†æœ¬åœ°åˆ†æ”¯æŒ‡å‘æœ€æ–°çš„æäº¤(H),å®ƒæ˜¯ä¸€ä¸ªåˆå¹¶æäº¤,å› ä¸ºå®ƒæœ‰ä¸¤ä¸ªçˆ¶æäº¤

ä½ ä¹Ÿå¯ä»¥åœ¨pullçš„æ—¶å€™æŒ‡å®š`--rebase`é€‰é¡¹,æŒ‡å®šè°ƒå’Œåˆ†æ­§çš„æ–¹å¼

è­¦å‘Š: æœ€å¥½åœ¨æ‹‰å–ä¹‹å‰å°†æœ¬åœ°ä¿®æ”¹å¼„åˆ°å·¥ä½œçŠ¶æ€,æˆ–ä½¿ç”¨git stashå‘½ä»¤æš‚å­˜

-->

---
layout: two-cols-header
growX: -10
growY: 100
---

## å˜åŸº vs. åˆå¹¶

<div my-2 />

```
	  A---B---C feat1
	 /
D---E---F---G master
```

::left::

### å˜åŸº

```
            A'--B'--C' topic
            /
D---E---F---G master
```

::right::

<div ml-2>

### åˆå¹¶

```
	  A---B---C feat1
	 /         \
D---E---F---G---H master
```

</div>

<!--

æ¥ä¸‹å¼€æˆ‘ä»¬æ¥æ¢è®¨ä¸‹rebaseä¸mergeçš„åŒºåˆ«
åœ¨Gitä¸­æœ‰ä¸¤ç§æ•´åˆæ¥è‡ªä¸åŒåˆ†æ”¯çš„ä¿®æ”¹æ–¹æ³•: mergeä¸rebase

å˜åŸºä¼šæå–Aã€Bã€Cä¸­å¼•å…¥çš„æäº¤å’Œä¿®æ”¹,ç„¶ååœ¨Fã€Gçš„åŸºç¡€ä¸Šåº”ç”¨ä¸€æ¬¡
> ä½¿ç”¨`rebase`å‘½ä»¤å°†æäº¤åˆ°æŸä¸€åˆ†æ”¯çš„æ‰€æœ‰ä¿®æ”¹éƒ½ç§»åˆ°å¦ä¸€åˆ†æ”¯ä¸­,å°±å¥½åƒâ€œé‡æ–°æ’­æ”¾â€ä¸€æ ·
> åŸç†æ˜¯é¦–å…ˆæ‰¾åˆ°è¿™ä¸¤ä¸ªåˆ†æ”¯çš„æœ€è¿‘å…±åŒç¥–å…ˆ,ç„¶åå¯¹æ¯”å½“å‰åˆ†æ”¯ç›¸å¯¹äºè¯¥ç¥–å…ˆçš„å†å²æäº¤,æå–ç›¸åº”çš„ä¿®æ”¹å¹¶å­˜ä¸ºä¸´æ—¶æ–‡ä»¶,ç„¶åå°†å½“å‰åˆ†æ”¯æŒ‡å‘ç›®æ ‡åŸºåº•,æœ€åä»¥æ­¤å°†ä¹‹å‰å¦å­˜ä¸ºä¸´æ—¶æ–‡ä»¶çš„ä¿®æ”¹ä¾åºåº”ç”¨.

åˆå¹¶ä¼šæŠŠä¼šæŠŠä¸¤ä¸ªåˆ†æ”¯çš„æœ€æ–°å¿«ç…§(Cã€G)ä»¥åŠäºŒè€…çš„å…±åŒç¥–å…ˆ(E)è¿›è¡Œ3æ–¹åˆå¹¶, åˆå¹¶äº§ç”Ÿæ–°çš„å¿«ç…§å¹¶æäº¤

è¿™ä¸¤ç§æ•´åˆçš„æ–¹æ³•æœ€ç»ˆç»“æœæ²¡ä»»ä½•åŒºåˆ«,ä½†æ˜¯å˜åŸºçš„å†å²æäº¤æ›´ä¸ºæ•´æ´.åœ¨æŸ¥çœ‹ç»è¿‡å˜åŸºçš„å†å²è®°å½•æ—¶å¯ä»¥çœ‹åˆ°,å°½ç®¡å®é™…å¼€å‘å·¥ä½œæ˜¯å¹¶è¡Œçš„,ä½†ä»–ä»¬çœ‹ä¸Šå»å°±åƒæ˜¯ä¸²è¡Œçš„ä¸€æ ·,æäº¤å†å²æ˜¯ä¸€æ¡ç›´çº¿æ²¡æœ‰åˆ†å‰

-->

---
layout: intro
growX: -10
growY: 80
---

### å˜åŸºçš„é£é™©

å˜åŸºæ“ä½œçš„å®è´¨æ˜¯ä¸¢å¼ƒä¸€äº›ç°æœ‰çš„æäº¤,ç„¶åç›¸åº”åœ°æ–°å»ºä¸€äº›å†…å®¹ä¸€æ ·ä½†å®é™…ä¸Šä¸åŒçš„æäº¤

```
  A--- feat1
 /
D---E--- master
```

userA (rebase)
```
      Aâ€™--- feat1
     /
D---E--- master
```

userB (HEAD)
```
      A---B--- feat1
     /
D---E--- master
     \
      Aâ€™--- origin/feat1
```

<!--
æ¼”ç¤ºå˜åŸºæ“ä½œçš„é£é™©

1. adminåœ¨mainåˆå§‹æäº¤å¹¶æ¨é€
2. userAåˆ›å»ºfeat1åˆ†æ”¯,ä¿®æ”¹å¹¶æ¨é€
3. userBåœ¨feat1åˆ†æ”¯,ä¿®æ”¹å¹¶æäº¤
4. adminåœ¨mainåˆ†æ”¯,ä¿®æ”¹å¹¶æäº¤
5. userAåœ¨feat1åˆ†æ”¯,`git rebase main`å˜åŸºå¹¶å¼ºåˆ¶æ¨é€
6. userBæ­¤æ—¶åœ¨feat1åˆ†æ”¯,å¤„å¢ƒå°´å°¬ğŸ˜…, å¦‚æœ`git pull`ä¼šè¿›è¡Œä¸€æ¬¡åˆå¹¶,ç”Ÿæˆæ–°çš„æäº¤å†…å®¹(æ¼”ç¤ºgit pull)
7. æ­¤æ—¶æŸ¥çœ‹ä¼šçœ‹åˆ°è¢«å˜åŸºçš„å†…å®¹è¢«æ‰¾äº†å›æ¥!

æœ‰äººæ¨é€äº†åŸºäºå˜åŸºçš„æäº¤å¹¶ä¸¢å¼ƒäº†ä½ æœ¬åœ°å¼€å‘æ‰€åŸºäºçš„ä¸€äº›ä¿®æ”¹ æ­¤æ—¶å¯ä»¥ä½¿ç”¨å˜åŸºè§£å†³å˜åŸº, gitå°†ä¼š:
> å˜åŸºæ—¶`A`å’Œ`A'`å‡ ä¹ä¸€æ ·, æ­¤æ—¶å†æ¬¡å˜åŸºå°†ä¼šåˆå¹¶è¿™ä¸¤ä¸ªæäº¤,å¹¶ä¸”ä¸ä¼šä¸¢å¤±`B`æäº¤

-->

---
layout: fact
growX: 50
growY: 50
---

# å˜åŸº vs. åˆå¹¶

<p pt-4 px-4>åªå¯¹å°šæœªæ¨é€æˆ–åˆ†äº«ç»™åˆ«äººçš„æœ¬åœ°ä¿®æ”¹æ‰§è¡Œå˜åŸºæ“ä½œæ¸…ç†å†å²ï¼Œä»ä¸å¯¹å·²æ¨é€è‡³åˆ«å¤„çš„æäº¤æ‰§è¡Œå˜åŸºæ“ä½œ</p>

<!--

æˆ‘ä»¬å·²ç»äº†è§£äº†å˜åŸºçš„é£é™©, é‚£ä»€ä¹ˆæƒ…å†µä¸‹é€‚åˆä½¿ç”¨å˜åŸºå‘¢?

-->

---
layout: intro
growX: 80
growY: 80
---

## cherry-pick / rebase / revert

- cherry-pick: è·å¾—åœ¨å•ä¸ªæäº¤ä¸­å¼•å…¥çš„å˜æ›´ï¼Œç„¶åå°è¯•å°†ä½œä¸ºä¸€ä¸ªæ–°çš„æäº¤å¼•å…¥åˆ°å½“å‰åˆ†æ”¯ä¸Š
- rebase: è‡ªåŠ¨åŒ–çš„ cherry-pick å‘½ä»¤, è®¡ç®—å‡ºä¸€ç³»åˆ—çš„æäº¤ï¼Œç„¶åå†ä»¥å®ƒä»¬åœ¨å…¶ä»–åœ°æ–¹ä»¥åŒæ ·çš„é¡ºåºä¸€ä¸ªä¸€ä¸ªçš„ cherry-picks å‡ºå®ƒä»¬ã€‚
- revert: æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé€†å‘çš„ git cherry-pick æ“ä½œ, å°†æäº¤ä¸­çš„å˜æ›´ä»¥å®Œå…¨ç›¸åçš„æ–¹å¼åº”ç”¨åˆ°ä¸€ä¸ªæ–°åˆ›å»ºçš„æäº¤ä¸­ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ’¤é”€æˆ–è€…å€’è½¬ã€‚

---
layout: intro
clicks: 3
growX: 100
growY: 100
---

## é‡ç½®

| æ ‘       | ç”¨é€”                            |
| -------- | ------------------------------- |
| HEAD     | ä¸Šæ¬¡æäº¤çš„å¿«ç…§,ä¸‹æ¬¡æäº¤çš„çˆ¶èŠ‚ç‚¹ |
| ç´¢å¼•     | é¢„æœŸçš„ä¸‹æ¬¡æäº¤å¿«ç…§              |
| å·¥ä½œç›®å½• | æ²™ç›’                            |

<div mt-4 flex algin-start text-center gap-8 :class="[!$clicks && 'invisible']">
<div w-50>
    <div bg-gray-200 px-2 py-1>HEAD</div>
    <div pt-4 border border-t-0 border-black>
        <div mx-4 mb-4 px-4 py-2 rounded-24 bg-sky-200 :class="[$clicks < 3 && 'invisible']">
            file.txt v1
        </div>
    </div>
    <div mt-2 :class="[$clicks < 3 && 'invisible']"><code>git commit</code></div>
</div>

<div w-50>
    <div bg-cyan-600 px-2 py-1 text-white>Index</div>
    <div pt-4 border border-t-0 border-black>
        <div mx-4 mb-4 px-4 py-2 rounded-24 bg-sky-200 :class="[$clicks < 2 && 'invisible']">
            file.txt v1
        </div>
    </div>
    <div mt-2 :class="[$clicks < 2 && 'invisible']"><code>git add</code></div>
</div>

<div w-50>
    <div bg-rose-600 px-2 py-1 text-white>Working Directory</div>
    <div pt-4 border border-t-0 border-black>
        <div mx-4 mb-4 px-4 py-2 rounded-24 bg-sky-200>
            file.txt v1
        </div>
    </div>
</div>
</div>

<!--

æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¢è®¨Gitçš„`reset`å’Œ`checkout`, ç›¸ä¿¡å¾ˆå¤šäººå¯¹è¿™ä¸¤ä¸ªå‘½ä»¤å¾ˆå›°æƒ‘, å®ƒä»¬çš„ä½œç”¨æœ‰å¾ˆå¤šé‡å , ä½†æ˜¯åˆæœ‰å¾ˆå¤šä¸åŒ

è¦çœŸæ­£ç†è§£å¹¶æ°å½“ä½¿ç”¨å®ƒä»¬,å°±è¦æŒ‰ç…§Gitçš„æ€ç»´æ–¹å¼æ¥æ€è€ƒ. è¿™ä¸¤ä¸ªå‘½ä»¤å°±æ˜¯ç®¡ç†å¹¶æ“ä½œGitçš„ä¸‰æ£µæ ‘

`HEAD`è¿™æ£µæ ‘, ä¸çŸ¥å¤§å®¶æœ‰æ²¡æœ‰æ³¨æ„åˆ°! åœ¨æœ€å¼€å§‹çš„å®éªŒä¸­,æˆ‘ä»¬æ‰“å°äº†`.git`çš„ç›®å½•ç»“æ„,å¯ä»¥çœ‹åˆ°æœ‰ä¸ª`HEAD`æ–‡ä»¶, è¿™ä¸ªæ–‡ä»¶å°±æ˜¯`HEAD`æ ‘çš„æŒ‡é’ˆ, å®ƒæŒ‡å‘å½“å‰æ‰€åœ¨åˆ†æ”¯çš„æŒ‡é’ˆ, ä¹Ÿå°±æ˜¯`refs/heads`ç›®å½•ä¸‹çš„æ–‡ä»¶
å¯ä»¥ç®€å•ç†è§£ä¸º: è¯¥åˆ†æ”¯æœ€åä¸€æ¬¡æäº¤çš„å¿«ç…§.
> `git cat-file -p ^HEAD` æŸ¥çœ‹HEADæŒ‡å‘çš„æäº¤
> `git ls-tree -r HEAD` æŸ¥çœ‹HEADæŒ‡å‘çš„æäº¤åŒ…å«çš„æ–‡ä»¶

ç´¢å¼•æ ‘æ˜¯é¢„æœŸçš„ä¸‹æ¬¡æäº¤, å³Gitçš„æš‚å­˜åŒº. é€šè¿‡`git add`å‘½ä»¤å¯ä»¥å°†å·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶æ·»åŠ åˆ°ç´¢å¼•æ ‘ä¸­, `git commit`é€šè¿‡ç´¢å¼•æ ‘ä¸­çš„æ–‡ä»¶åˆ›å»ºæ–°çš„æäº¤
> `gut ls-files -s`æŸ¥çœ‹ç´¢å¼•æ–‡ä»¶

å·¥ä½œç›®å½•ä¹Ÿè¢«ç§°ä¸ºå·¥ä½œåŒº, å®ƒæ˜¯Gitçš„æ²™ç›’, ä½ å¯ä»¥åœ¨å…¶ä¸­ä¿®æ”¹æ–‡ä»¶, æ·»åŠ æ–‡ä»¶, åˆ é™¤æ–‡ä»¶, ä½†æ˜¯è¿™äº›ä¿®æ”¹å¹¶ä¸ä¼šå½±å“ç´¢å¼•æ ‘å’ŒHEADæ ‘, é™¤éä½ æ‰§è¡Œ`git add`å‘½ä»¤, å°†å·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶æ·»åŠ åˆ°ç´¢å¼•æ ‘ä¸­

åŠ¨ç”»æ¼”ç¤º:
1. åˆ‡æ¢åˆ†æ”¯æˆ–å…‹éš†æ—¶,HEADæŒ‡å‘æ–°çš„åˆ†æ”¯å¼•ç”¨, æ­¤æ—¶åªæœ‰å·¥ä½œç›®å½•æœ‰å†…å®¹
2. è¿è¡Œ`git add`è·å–å·¥ä½œç›®å½•ä¸­çš„å†…å®¹, å¹¶å°†å…¶å¤åˆ¶åˆ°ç´¢å¼•ä¸­
3. è¿è¡Œ`git commit`è·å–ç´¢å¼•ä¸­çš„å†…å®¹å¹¶ä¿å­˜ä¸ºä¸€ä¸ªæ°¸ä¹…å¿«ç…§,ç„¶ååˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥å¿«ç…§çš„æäº¤å¯¹è±¡,å¹¶å°†HEADæŒ‡å‘è¯¥æäº¤å¯¹è±¡(refs/heads/masterçš„æŒ‡å‘æ–°çš„SHA-1å€¼)
4. æ­¤æ—¶ä¸‰æ£µæ ‘å·²ç»å®Œå…¨ç›¸åŒ

-->

---
layout: intro
growX: 100
growY: 20
---

## é‡ç½®

<div mt-4 />

<v-click>

- `--soft` ä»…ç§»åŠ¨HEADæŒ‡é’ˆæŒ‡å‘
- `--mixed` ç§»åŠ¨HEADæŒ‡é’ˆå’Œé‡ç½®ç´¢å¼•(å–æ¶ˆæš‚å­˜æ–‡ä»¶,ä¸`git add`ç›¸å)
- `--hard` ç§»åŠ¨HEADæŒ‡é’ˆã€é‡ç½®ç´¢å¼•å’Œé‡ç½®å·¥ä½œç›®å½•

</v-click>

<v-click>

è¯¯ `reset` åçš„æ•°æ®æ¢å¤:

1. `git reflog` å¼•ç”¨æ—¥å¿—
    ```shell
    $ git reflog
    $ git reset --hard HEAD@{1}
    ```

2. `git fsck` æ£€æŸ¥æ•°æ®åº“å®Œæ•´æ€§
    ```shell
    $ git fsck --full
    $ git reset --hard HEAD@{1}
    ```

</v-click>

<!--
æ¥ä¸‹æ¥æˆ‘ä»¬ä»¥ä¸€äº›å…·ä½“çš„æ“ä½œæ¥æ¼”ç¤º`git reset`å®é™…çš„æ•ˆæœ

æ¼”ç¤º

æ€»ç»“ä¸‹resetçš„ä¸‰ç§æ¨¡å¼

-->

---
layout: fact
growX: 80
growY: 20
---

<div text-4xl>

`checkout` ä¸ `reset` çš„åŒºåˆ«

</div>


<div mt-6 mx-16 leading-8>

1. `git checkout <branch>` ä¸ `git reset --hard <branch>` ç±»ä¼¼, ä½†æ˜¯ `checkout` å¯¹å·¥ä½œç›®å½•æ˜¯å®‰å…¨çš„,å®ƒä¼šé€šè¿‡æ£€æŸ¥æ¥ç¡®ä¿ä¸ä¼šå°†ä»¥æ›´æ”¹æ–‡ä»¶ä¸¢æ‰(å…ˆè¯•ç€ç®€å•åˆ), è€Œ `reset` åˆ™ä¼šå¼ºåˆ¶è¦†ç›–å·¥ä½œç›®å½•


2. `git reset master` , developè‡ªèº«å’ŒmasteræŒ‡å‘åŒä¸€ä¸ªæäº¤; `git checkout master` , developä¸ä¼šç§»åŠ¨,HEADè‡ªèº«ä¼šç§»åŠ¨(æŒ‡å‘master)

</div>

<!--

resetå’Œcheckoutæœ‰å¦‚ä¸‹é‡è¦åŒºåˆ«

-->

---
layout: intro
growX: 50
growY: 20
---

### æ’¤é”€åˆå¹¶

<div mt-4 />

1. ç§»åŠ¨åˆ†æ”¯ `git reset --hard <hash>`
2. è¿˜åŸæäº¤ `git revert -m 1 HEAD~`

<!--

è®²åˆ°é‡ç½®, æœ‰ä¸€ä¸ªå¸¸è§çš„åœºæ™¯å°±ä¸å¾—ä¸æ, é‚£å°±æ˜¯æ’¤é”€åˆå¹¶æäº¤.

å¸¸è§çš„æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹æ³•.

ç¬¬ä¸€ç§ç¼ºç‚¹æ˜¯ä¼šé‡å†™å†å², åœ¨å¤šäººåä½œçš„é¡¹ç›®ä¸­, ä¼šé€ æˆå¾ˆå¤§çš„éº»çƒ¦.
ç§»åŠ¨åˆ†æ”¯ä¼šä¸¢å¤±é‚£äº›åœ¨åˆå¹¶ä¹‹åæäº¤çš„å†…å®¹

ç¬¬äºŒç§æ–¹å¼æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤, è¯¥æäº¤ä¼šæ’¤å›æ‰€æœ‰å·²ç»å­˜åœ¨æäº¤çš„æ‰€æœ‰æ›´æ”¹. Gitç§°è¿™ä¸ªæ“ä½œä¸ºè¿˜åŸ.
å…¶ä¸­ `-m` (mainline) é€‰é¡¹æŒ‡å®šè¦ä¿ç•™çš„çˆ¶èŠ‚ç‚¹, å½“æäº¤æ—¶ä¼šæœ‰2ä¸ªçˆ¶èŠ‚ç‚¹, ä¸€ä¸ªæ˜¯HEAD, ä¸€ä¸ªæ˜¯åˆå¹¶çš„åˆ†æ”¯, é€šè¿‡è¯¥é€‰é¡¹å¯ä»¥æŒ‡å®šè¦ä¿ç•™çš„çˆ¶èŠ‚ç‚¹
è¿™ä¸ªæ“ä½œä¹Ÿæ˜¯æœ‰é£é™©çš„, åˆå¹¶å‰ä¸åˆå¹¶å‰å…¬å…±æäº¤èŠ‚ç‚¹é—´çš„æ‰€æœ‰æäº¤éƒ½ä¼šä¸¢å¤±, é™¤éå†æ¬¡è¿˜åŸé‚£æ¬¡è¿˜åŸæäº¤.
æ­¤å¤–, åœ¨åˆå¹¶ä¹‹å‰éœ€è¦ç¡®ä¿è¢«è¿˜åŸåˆ†æ”¯ã€åˆå¹¶åˆ†æ”¯ä¸å…¶ä¸¤è€…çš„å…¬å…±åˆ†æ”¯ä¹‹å‰ä¿æŒåŒæ­¥(å³å…¬å…±çš„çˆ¶èŠ‚ç‚¹ä¿æŒä¸€è‡´), å¦åˆ™è¿™éƒ¨åˆ†æäº¤ä¹Ÿä¼šä¸¢å¤±

-->

---
layout: intro
growX: 10
growY: 20
---

## é‡å†™å†å²

<div mt-4 />

- é‡å†™æœ€åä¸€æ¬¡æäº¤
- ä¿®æ”¹å¤šä¸ªæäº¤ä¿¡æ¯

<!--

Gitå¯ä»¥åœ¨æœ¬åœ°éšä¾¿é‡å†™å†å², æ¥ä¸‹æ¥äº†è§£ä¸‹é‡å†™å†å²çš„ä¸€äº›æ“ä½œ

-->

---
layout: intro
growX: 10
growY: 50
---

### é‡å†™æœ€åä¸€æ¬¡æäº¤

<div mt-4 />

- ä¿®æ”¹ä¸Šæ¬¡çš„æäº¤ä¿¡æ¯
- æ·»åŠ é—æ¼çš„æ–‡ä»¶
- ä¿®æ”¹ä¸Šæ¬¡æäº¤çš„æ–‡ä»¶

<div mt-3 />

```shell
$ git commit --amend
```

<!--

ä¸€èˆ¬å¸¸è§æœ‰: ä¿®æ”¹ä¸Šæ¬¡çš„æäº¤ä¿¡æ¯ã€æ·»åŠ é—æ¼çš„æ–‡ä»¶ã€ä¿®æ”¹ä¸Šæ¬¡æäº¤çš„æ–‡ä»¶

å¯åœ¨æ‰§è¡Œ`git commit`æ—¶å¢åŠ `--amend`é€‰é¡¹ é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤æ›¿æ¢ä¸Šä¸€æ¬¡æäº¤

-->

---
layout: intro
growX: 10
growY: 80
---

### ä¿®æ”¹å¤šä¸ªæäº¤ä¿¡æ¯

<div mt-4 />

```shell
$ git rebase -i HEAD~3
```

<div mt-4 />

- `edit` ä¿®æ”¹æäº¤ä¿¡æ¯
- `reword` ä»…ä¿®æ”¹æäº¤ä¿¡æ¯
- `squash` ä¸å‰ä¸€ä¸ªæäº¤åˆå¹¶
- `fixup` ä¸å‰ä¸€ä¸ªæäº¤åˆå¹¶, ä½†ä¸¢å¼ƒæäº¤ä¿¡æ¯

<!--

Gitæ²¡æä¾›æ”¹å˜å†å²çš„å·¥å…·, ä½†å¯ä»¥ä½¿ç”¨å˜åŸºå·¥å…·æ¥å˜åŸºä¸€ç³»åˆ—æäº¤

é€šè¿‡äº¤äº’å¼å˜åŸº, å¯ä»¥åœ¨ä»»ä½•æƒ³è¦ä¿®æ”¹çš„æäº¤ååœæ­¢, ç„¶åä¿®æ”¹ä¿¡æ¯ã€æ·»åŠ æ–‡ä»¶æˆ–åšä»»ä½•æƒ³åšçš„äº‹

1. æ–°å»ºä»“åº“, å¹¶åˆ›å»º3ä¸ªæäº¤
2. æ‰§è¡Œ`git rebase -i HEAD~3`å‘½ä»¤, ä¼šæ‰“å¼€ä¸€ä¸ªç¼–è¾‘å™¨, å…¶ä¸­åŒ…å«äº†3ä¸ªæäº¤çš„ä¿¡æ¯
3. å±•ç¤ºé¡ºåºä¸`git log`ç›¸å, å› ä¸ºå˜åŸºéœ€è¦ä»è¿œè‡³è¿‘é‡æ”¾æäº¤
4. å¯ä»¥ç¼–è¾‘å¯¹åº”commitå‰çš„æŒ‡ä»¤,åšä¸€ç³»åˆ—æ“ä½œ
5. æäº¤é¡ºåºä¹Ÿå¯ä»¥é‡æ–°æ’åºæˆ–ç§»é™¤
6. ä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›æŠ€å·§, å®ç°å°†ä¸€ä¸ªæäº¤æ‹†åˆ†ä¸ºå¤šä¸ª
   1. ä½¿ç”¨`edit`æŒ‡ä»¤ä¿®æ”¹æäº¤ä¿¡æ¯
   2. æ‰§è¡Œ`git reset HEAD^`å‘½ä»¤, æ’¤é”€æ­¤æ¬¡æäº¤å¹¶å°†ä¿®æ”¹ä»æš‚å­˜åŒºç§»å‡º
   3. å¤šæ¬¡æ‰§è¡Œ`git add`ã€`git commit`å‘½ä»¤, å°†ä¿®æ”¹åˆ†ä¸ºå¤šä¸ªæäº¤
   4. æ‹†åˆ†å®Œæˆå, æ‰§è¡Œ`git rebase --continue`å‘½ä»¤, ç»§ç»­å˜åŸºæ“ä½œ

-->

---
layout: intro
growX: 40
growY: 100
---

### æ‰¹é‡æ”¹å†™å†å²æäº¤ [âš ï¸](https://git-scm.com/docs/git-filter-branch/zh_HANS-CN#_warning)


- è¯¯æäº¤äº†æ¶‰å¯†å†…å®¹ã€å¤§æ–‡ä»¶ (alternative: [BFG Repo-Cleaner](https://rtyley.github.io/bfg-repo-cleaner/))
    ```shell
    $ git filter-branch --tree-filter 'rm -f passwords.txt' HEAD
    ```

- ä¿®æ”¹æäº¤äººã€ä½œè€…çš„å§“åã€é‚®ç®±
    ```shell
    $ git filter-branch --commit-filter '
            if [ "$GIT_AUTHOR_EMAIL" = "mekhi@work" ];
            then
                    GIT_AUTHOR_NAME="Mekhi El";
                    GIT_AUTHOR_EMAIL="mekhi@personal.com";
                    git commit-tree "$@";
            else
                    git commit-tree "$@";
            fi' -- --all
    ```

- å°†å­ç›®å½•ç‹¬ç«‹æˆå•ç‹¬çš„ä»“åº“
    ```shell
    $ git filter-branch --subdirectory-filter apps/miniapp HEAD
    ```

<!--
å¦‚æœéœ€è¦ä¿®æ”¹å¤šä¸ªå†å²æäº¤ä¿¡æ¯, å¯ä»¥ä½¿ç”¨`git filter-branch`å‘½ä»¤
å®ƒä¼šé‡å†™å†å²ä¸­æ‰€æœ‰æäº¤, å¹¶å°†å…¶åº”ç”¨åˆ°æ–°çš„æäº¤ä¸­
-->

---
layout: intro
growX: 50
growY: 120
---

## submodule ä¸ subtree

<div mt-4 />

- submodule
  - ä»“åº“ä¸­åŒ…å«å¦ä¸€ä¸ªä»“åº“, å­æ¨¡å—æ˜¯ç‹¬ç«‹çš„(æœ‰è‡ªå·±çš„`.git`ç›®å½•)
  - åœ¨å­æ¨¡å—ç›®å½•å¯ä»¥: pullã€addã€commitã€push
  - å¯å¤šå±‚åµŒå¥—
  - cloneæ—¶éœ€è¦æŒ‡å®š`--recursive-submodules`é€‰é¡¹ (å¯é…ç½®`submodule.recurse`)
- subtree
  - ä»“åº“ä¸­åŒ…å«å¦ä¸€ä¸ªä»“åº“çš„å¿«ç…§ (`git subtree add`æ—¶ä¼šåˆ›å»ºä¸€æ¡æäº¤è®°å½•, è®°å½•SHA-1å€¼)
  - å’Œä»“åº“å…¶ä»–ç›®å½•æ²¡åŒºåˆ«, åœ¨subtreeç›®å½•ä¸‹çš„æ”¹åŠ¨ä¼šè¢«Gitæ£€æµ‹åˆ°
  - å…è®¸å•ç‹¬pushã€pullåˆ°å­é¡¹ç›®

<div flex content-between gap-4>

```shell
$ git submodule add <url> <path>
$ git submodule update --init --recursive
$ git submodule update --remote --rebase
```

```shell
$ git subtree add --prefix=<prefix> <repository> <ref>
$ git subtree pull --prefix=<prefix> <repository> <ref>
$ git subtree push --prefix=<prefix> <repository> <ref>
```

</div>

[å­æ¨¡å—ç¤ºä¾‹](https://github.com/fw6/blog/tree/master/src/content)

<!--

Gitæä¾›äº†ä¸¤ç§æ–¹å¼æ¥ç®¡ç†å­ä»“åº“: submoduleä¸subtree

submodule: ä»“åº“ä¸­åŒ…å«å¦ä¸€ä¸ªä»“åº“, ä½†æ˜¯å®ƒä»¬æ˜¯ç‹¬ç«‹çš„, ä»“åº“AåŒ…å«ä»“åº“B, ä½†æ˜¯ä»“åº“Bçš„ä¿®æ”¹ä¸ä¼šå½±å“ä»“åº“A, ä»“åº“Açš„ä¿®æ”¹ä¹Ÿä¸ä¼šå½±å“ä»“åº“B

subtree: ä»“åº“ä¸­åŒ…å«å¦ä¸€ä¸ªä»“åº“çš„å¿«ç…§, ä»“åº“AåŒ…å«ä»“åº“Bçš„å¿«ç…§, ä»“åº“Bçš„ä¿®æ”¹ä¸ä¼šå½±å“ä»“åº“A, ä»“åº“Açš„ä¿®æ”¹ä¹Ÿä¸ä¼šå½±å“ä»“åº“B

-->

---
layout: intro
growX: 50
growY: 70
---

## Gitå·¥å…·

<div mt-4 />

> æä¾›ç»™Gitçš„SHA-1å­—ç¬¦æ•°é‡ä¸å°‘äº4ä¸ªä¸”æ— æ­§ä¹‰, å³å¯è·å¾—æ­¤æ¬¡æäº¤

<div mt-4 />

- æŸ¥çœ‹å¼•ç”¨æ—¥å¿—: `git reflog`
- ä½¿ç”¨ç¥–å…ˆå¼•ç”¨: `^` (è„±å­—ç¬¦), `~` (æ³¢æµªå·), ä¾‹: `git reset HEAD~3^2`
- æäº¤åŒºé—´
  - `git log master..develop` : åœ¨developè€Œä¸åœ¨masterä¸Šçš„æäº¤
  - `git log develop HEAD ^master` : åœ¨å½“å‰åˆ†æ”¯å’Œdevelopä¸åœ¨masterä¸Šçš„æäº¤
  - `git log master...develop --left-right --oneline` : è¢«å…¶ä¸­ä¹‹ä¸€åŒ…å«ä½†ä¸è¢«åŒæ—¶åŒ…å«çš„æäº¤
- è´®è—ä¸æ¸…ç†: `git stash apply`, `git stash pop`, `git stash drop`
- æ¸…ç†å·¥ä½œç›®å½•: `git clean -f -d` ä»å·¥ä½œç›®å½•ä¸­ç§»é™¤æœªè·Ÿè¸ªçš„æ–‡ä»¶å’Œç›®å½•, `-x`é€‰é¡¹ä¼šç§»é™¤è¢«å¿½ç•¥çš„æ–‡ä»¶

<!--

Gitæä¾›äº†å¾ˆå¤šä½¿ç”¨çš„å·¥å…·, è¿™é‡Œæˆ‘ä»¬ç®€å•ä»‹ç»å‡ ä¸ª

åœ¨ä½ å·¥ä½œæ—¶Gitä¼šåœ¨åå°ä¿å­˜ä¸€ä¸ªå¼•ç”¨æ—¥å¿—, å®ƒåŒ…å«äº†æœ€è¿‘å‡ ä¸ªæœˆä½ çš„HEADå’Œåˆ†æ”¯å¼•ç”¨æŒ‡å‘çš„å†å²
æ¯å½“HEADæŒ‡å‘çš„ä½ç½®å‘ç”Ÿå˜åŒ–, Gitå°±ä¼šå°†è¿™ä¸ªä¿¡æ¯å­˜å‚¨åˆ°å¼•ç”¨æ—¥å¿—ä¸­, å®ƒå¯ä»¥é…åˆå…¶ä»–å‘½ä»¤ä½¿ç”¨
éœ€è¦æ³¨æ„, å¼•ç”¨æ—¥å¿—åªå­˜åœ¨äºæœ¬åœ°

éœ€è¦æŒ‡å®šå¼•ç”¨çš„ä¸Šä¸€ä¸ªæäº¤, å¯åœ¨å¼•ç”¨ååŠ å¦‚ä¸Šä¸¤ä¸ª ç¬¦å·, ^åé¢å¯ä»¥åŠ æ•°å­—, ä½†éœ€æ³¨æ„åªèƒ½ç”¨åœ¨åˆå¹¶æäº¤ä¸Š,å› ä¸ºè¿™è¡¨ç¤ºç¬¬å‡ ä¸ªçˆ¶æäº¤
~åé¢å¯ä»¥åŠ æ•°å­—, è¡¨ç¤ºç¬¬å‡ ä»£çˆ¶æäº¤, å¦‚æœåŠ æ•°å­—, åˆ™è¡¨ç¤ºç¬¬å‡ ä¸ªçˆ¶æäº¤

è¿™ä¸¤ä¸ªæŒ‡ä»¤å¯ä»¥ç»„åˆ, å¦‚`git reset HEAD~3^2` è¡¨ç¤ºå¼•ç”¨çš„ç¬¬ä¸‰ä¸ªçˆ¶æäº¤çš„ç¬¬äºŒçˆ¶æäº¤

å½“æˆ‘ä»¬åœ¨æŸ¥çœ‹Gitæ—¥å¿—æ—¶ éœ€è¦è¿‡æ»¤æŸä¸ªåŒºé—´çš„æäº¤, è¿™æ—¶å¯ä»¥ä½¿ç”¨æäº¤åŒºé—´è¯­æ³•.
- `master..develop`: è¡¨ç¤ºdevelopåˆ†æ”¯ä¸Šè¿˜æœ‰å“ªäº›æäº¤æ²¡åˆå…¥masteråˆ†æ”¯

è´®è—ä¼šå¤„ç†å·¥ä½œç›®å½•è„çš„çŠ¶æ€(å³è·Ÿè¸ªæ–‡ä»¶å’Œæš‚å­˜çš„æ”¹åŠ¨)ä¿å­˜åˆ°æ ˆä¸Š, ä½ åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥é‡æ–°åº”ç”¨è¿™äº›æ”¹åŠ¨.
ä½ ä¹Ÿå¯ä»¥åœ¨è´®è—æ—¶é€šè¿‡`-u`é€‰é¡¹å°†æœªè·Ÿè¸ªçš„æ–‡ä»¶ä¹Ÿè´®è—èµ·æ¥


-->

---
layout: intro
growX: 40
growY: 90
---

## è°ƒè¯•

<div mt-4 />

- `git bisect` äºŒåˆ†æŸ¥æ‰¾æäº¤å†å²
  1. `git bisect start`
  2. `git bisect bad` æ ‡è®°å½“å‰æäº¤ä¸ºåæäº¤
  3. `git bisect good <hash>` æ ‡è®°ä¸€ä¸ªå·²çŸ¥çš„å¥½æäº¤
  4. Gitæ£€å‡ºä¸­é—´æäº¤, ä½¿ç”¨`git bisect <goog | bad>`æ ‡è®°ä¸ºå¥½æˆ–å
  5. `git bisect reset` é€€å‡ºäºŒåˆ†æŸ¥æ‰¾
- `git blame` æ–‡ä»¶æ ‡æ³¨, æŸ¥çœ‹æ–‡ä»¶çš„æ¯ä¸€è¡Œæ˜¯è°ä¿®æ”¹çš„
- `git grep` ä»æäº¤å†å²ã€å·¥ä½œç›®å½•ã€ç´¢å¼•ä¸­æŸ¥æ‰¾æ–‡æœ¬ã€æ­£åˆ™è¡¨è¾¾å¼

<!--
Git æä¾›äº†ä¸€äº›å·¥å…·æ¥å¸®åŠ©ä½ è°ƒè¯•
 -->

---
layout: intro
growX: 20
growY: 100
---

## é…ç½® Git

<div mt-4 />

- é…ç½®æ–‡ä»¶
  - `/etc/gitconfig` : ç³»ç»Ÿçº§é…ç½®æ–‡ä»¶
  - `~/.gitconfig` æˆ– `~/.config/git/config` : ç”¨æˆ·çº§é…ç½®æ–‡ä»¶, å¯¹åº” `git config --global`
  - `.git/config` : ä»“åº“é…ç½®æ–‡ä»¶, å¯¹åº”`git config --local`
- å±æ€§: [.gitattributes](https://github.com/gitattributes/gitattributes)
  - `*.docx diff=word` åŒ¹é…`.docx`æ–‡ä»¶ä½¿ç”¨`word`è¿‡æ»¤å™¨(å°†wordæ–‡æ¡£è½¬ä¸ºå¯è¯»æ–‡æœ¬æ–‡ä»¶, ä¾¿äºæŸ¥çœ‹å·®å¼‚), å¢åŠ é…ç½® `git config diff.word.textconv docx2txt`
  - `*.pbxproj binary` å°†æ‰€æœ‰è¯¥æ–‡ä»¶ä½œä¸ºäºŒè¿›åˆ¶æ–‡ä»¶å¤„ç†, ä¸è¿›è¡Œå·®å¼‚æ¯”è¾ƒ
- å¿½ç•¥æ–‡ä»¶: [.gitignore](https://github.com/github/gitignore)
- [ç¯å¢ƒå˜é‡](https://git-scm.com/book/en/v2/Git-Internals-Environment-Variables)
- hooks
  - å®¢æˆ·ç«¯é’©å­: æäº¤å·¥ä½œæµé’©å­ã€ç”µå­é‚®ä»¶å·¥ä½œæµé’©å­ã€å…¶ä»–é’©å­
  - æœåŠ¡å™¨ç«¯é’©å­: pre-receiveã€updateã€post-receive

<!--

Gitçš„é…ç½®æ–‡ä»¶æœ‰ä¸‰ä¸ª, ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸º: `.git/config`ã€`~/.gitconfig`ã€`/etc/gitconfig`

Gité…ç½®æ–‡ä»¶æ˜¯çº¯æ–‡æœ¬ç±»å‹, å¯ä»¥ç›´æ¥ç¼–è¾‘, ä¹Ÿå¯ä»¥é€šè¿‡`git config`å‘½ä»¤è¿›è¡Œé…ç½®

Gitå±æ€§, æ˜¯åŸºäºè·¯å¾„çš„é…ç½®é¡¹, å¯ä»¥é’ˆå¯¹ç‰¹å®šè·¯å¾„è®¾ç½®æŸäº›è®¾ç½®é¡¹, ä¾‹å¦‚: æŒ‡å®šæŸäº›æ–‡ä»¶ä½¿ç”¨ç‰¹å®šçš„diffå·¥å…·, æˆ–è€…æŒ‡å®šæŸäº›æ–‡ä»¶ä½¿ç”¨ç‰¹å®šçš„æ¢è¡Œç¬¦

-->

---
layout: end
---
